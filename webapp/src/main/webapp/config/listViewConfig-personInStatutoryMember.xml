<?xml version="1.0" encoding="ISO-8859-1"?>
<!-- $This file is distributed under the terms of the license in /doc/license.txt$ -->

<!-- See guidelines at https://wiki.duraspace.org/x/eYXVAw -->

<list-view-config>
    <query-select>
        PREFIX rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt;
        PREFIX core: &lt;http://vivoweb.org/ontology/core#&gt;
        PREFIX vitro: &lt;http://vitro.mannlib.cornell.edu/ns/vitro/0.7#&gt;
        PREFIX obo: &lt;http://purl.obolibrary.org/obo/&gt;
        PREFIX ehess: &lt;http://data.ehess.fr/ontology/vivo#>
        SELECT DISTINCT
            ?appStatutaire
            ?uniteRecherche ?labelAppStatutaire ?abrAppStatutaire
            ?appartenanceEquipe
            ?composanteUnite ?labelAppartenance
            ?dateTimeStart ?dateTimeEnd
        WHERE
        {
            ?subject ?property ?appStatutaire .
            ?appStatutaire vitro:mostSpecificType ?objectType .
            ?appStatutaire core:relates ?uniteRecherche .
            ?uniteRecherche vitro:mostSpecificType ehess:UniteDeRecherche .
        OPTIONAL {
            ?uniteRecherche rdfs:label ?labelAppStatutaire .
        }
        OPTIONAL {
            ?uniteRecherche core:abbreviation ?abrAppStatutaire .
        }
        OPTIONAL
        {
            ?appStatutaire core:dateTimeInterval ?dateTimeInterval .
            ?dateTimeInterval core:start ?dateTimeStartValue .
            ?dateTimeStartValue core:dateTime ?dateTimeStart .
        }
        OPTIONAL
        {
            ?appStatutaire core:dateTimeInterval ?dateTimeInterval .
            ?dateTimeInterval core:end ?dateTimeEndValue .
            ?dateTimeEndValue core:dateTime ?dateTimeEnd .
        }
        OPTIONAL
        {
            ?subject ?property ?appartenanceEquipe .
            ?appartenanceEquipe vitro:mostSpecificType ?objectType .
            ?appartenanceEquipe core:relates ?composanteUnite .
            ?composanteUnite a ehess:ComposanteDUnite .
            OPTIONAL {
                ?composanteUnite rdfs:label ?labelAppartenance .
            }
        }
        <critical-data-required>
            FILTER ( bound(?org) )
        </critical-data-required>
        } ORDER BY <collated>?subclass</collated> DESC(?dateTimeEnd) ?rank
    </query-select>

    <query-construct>
        PREFIX rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt;
        PREFIX core: &lt;http://vivoweb.org/ontology/core#&gt;
        PREFIX vitro: &lt;http://vitro.mannlib.cornell.edu/ns/vitro/0.7#&gt;
        PREFIX obo: &lt;http://purl.obolibrary.org/obo/&gt;
        PREFIX ehess: &lt;http://data.ehess.fr/ontology/vivo#>
        CONSTRUCT
        {
            ?subject ?property ?appStatutaire .
            ?appStatutaire vitro:mostSpecificType ?objectType .
            ?appStatutaire core:dateTimeInterval ?dateTimeInterval .
            ?dateTimeInterval core:start ?dateTimeStartValue .
            ?dateTimeStartValue core:dateTime ?dateTimeStart .
            ?dateTimeInterval core:end ?dateTimeEndValue .
            ?dateTimeEndValue core:dateTime ?dateTimeEnd .
            ?appStatutaire core:relates ?uniteRecherche .
            ?uniteRecherche rdfs:label ?labelAppStatutaire .
            ?uniteRecherche  core:abbreviation ?abrAppStatutaire .
            ?subject ?property ?appartenanceEquipe .
            ?appartenanceEquipe vitro:mostSpecificType  ?objectType .
            ?uniteRecherche vitro:mostSpecificType  ehess:UniteDeRecherche .
            ?appartenanceEquipe core:relates ?composanteUnite .
            ?composanteUnite rdfs:label ?labelAppartenance .
            ?composanteUnite a  ehess:ComposanteDUnite .
        }
        WHERE
        {
        ?subject ?property ?appStatutaire .
        ?appStatutaire vitro:mostSpecificType ?objectType .
        ?appStatutaire core:relates ?uniteRecherche .
        ?uniteRecherche vitro:mostSpecificType ehess:UniteDeRecherche .
        OPTIONAL {
            ?uniteRecherche rdfs:label ?labelAppStatutaire .
        }
        OPTIONAL {
            ?uniteRecherche core:abbreviation ?abrAppStatutaire .
        }
        OPTIONAL
        {
            ?appStatutaire core:dateTimeInterval ?dateTimeInterval .
            ?dateTimeInterval core:start ?dateTimeStartValue .
            ?dateTimeStartValue core:dateTime ?dateTimeStart .
        }
        OPTIONAL
        {
            ?appStatutaire core:dateTimeInterval ?dateTimeInterval .
            ?dateTimeInterval core:end ?dateTimeEndValue .
            ?dateTimeEndValue core:dateTime ?dateTimeEnd .
        }
        OPTIONAL
        {
            ?subject ?property ?appartenanceEquipe .
            ?appartenanceEquipe vitro:mostSpecificType ?objectType .
            ?appartenanceEquipe core:relates ?composanteUnite .
            ?composanteUnite a ehess:ComposanteDUnite .
            OPTIONAL {
                ?composanteUnite rdfs:label ?labelAppartenance .
            }
        }
        }

    </query-construct>

    <template>propStatement-personInStatutoryMember.ftl</template>
</list-view-config>
